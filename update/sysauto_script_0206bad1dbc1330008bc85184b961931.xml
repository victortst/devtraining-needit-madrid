<?xml version="1.0" encoding="UTF-8"?><record_update table="sysauto_script">
    <sysauto_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <condition/>
        <conditional>false</conditional>
        <name>Find Overdue NeedIt Tasks</name>
        <run_as display_value="System Administrator">6816f79cc0a8016401c5a33be04be441</run_as>
        <run_as_tz/>
        <run_dayofmonth>1</run_dayofmonth>
        <run_dayofweek>1</run_dayofweek>
        <run_period/>
        <run_start>2019-04-25 18:17:48</run_start>
        <run_time>1970-01-01 14:00:00</run_time>
        <run_type>daily</run_type>
        <script><![CDATA[// Get today's time and date
	var rightNow = new GlideDateTime();
	
	// Query the database for NeedIt Task records with Due date field values older
	// than the current time.  Only return NeedIt Task records that do not have
	// a State field value of Closed Complete.
	var overdueNITasks = new GlideRecord('x_58872_needit_needit_task');
	overdueNITasks.addQuery('due_date','<=',rightNow);
	overdueNITasks.addQuery('state','!=',3);
    overdueNITasks.addQuery('number','NITASK003625');

	
	overdueNITasks.query();
	// Write a log message for each overdue NeedIt Task Record
	while(overdueNITasks.next()){
		gs.info("vc: Overdue NeedIt Task record = " + overdueNITasks.number);
		overdueNITasks.priority = 2;
        overdueNITasks.update();
		//gs.eventQueue('x_58872_needit.overdueNeedItTask',overdueNITasks,overdueNITasks.number,gs.getUserName());
		
	}
/*
QUESTION: Which object is passed to the event generated by gs.eventQueue()? Why this object and not current?
ANSWER: Scheduled Script Executions do not have access to the current object because they trigger based on time and not on record accesses. In this script, the gs.eventQueue() method generates an event for each overdue NeedIt Task record found by the GlideRecord query. The overdueNITasks object is passed to the event as the script iterates through the while loop. Parm1 contains the record number. The record number appears in the Event Log in its resolved value.
*/
]]></script>
        <sys_class_name>sysauto_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2019-04-25 18:18:41</sys_created_on>
        <sys_id>0206bad1dbc1330008bc85184b961931</sys_id>
        <sys_mod_count>4</sys_mod_count>
        <sys_name>Find Overdue NeedIt Tasks</sys_name>
        <sys_package display_value="NeedIt" source="x_58872_needit">6ead8e780f603200cd674f8ce1050ed1</sys_package>
        <sys_policy/>
        <sys_scope display_value="NeedIt">6ead8e780f603200cd674f8ce1050ed1</sys_scope>
        <sys_update_name>sysauto_script_0206bad1dbc1330008bc85184b961931</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2019-06-21 19:06:21</sys_updated_on>
        <upgrade_safe>false</upgrade_safe>
    </sysauto_script>
</record_update>
